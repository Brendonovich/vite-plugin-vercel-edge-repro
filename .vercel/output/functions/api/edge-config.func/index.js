"use strict";var _=Object.create;var g=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,B=Object.prototype.hasOwnProperty;var I=(e,r)=>{for(var t in r)g(e,t,{get:r[t],enumerable:!0})},m=(e,r,t,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let c of P(r))!B.call(e,c)&&c!==t&&g(e,c,{get:()=>r[c],enumerable:!(a=$(r,c))||a.enumerable});return e};var x=(e,r,t)=>(t=e!=null?_(k(e)):{},m(r||!e||!e.__esModule?g(t,"default",{value:e,enumerable:!0}):t,e)),F=e=>m(g({},"__esModule",{value:!0}),e);var W={};I(W,{GET:()=>S});module.exports=F(W);var i={UNEXPECTED:"@vercel/edge-config: Unexpected error",UNAUTHORIZED:"@vercel/edge-config: Unauthorized",NETWORK:"@vercel/edge-config: Network error",EDGE_CONFIG_NOT_FOUND:"@vercel/edge-config: Edge Config not found"};function O(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function T(e,r){let t={};return r.forEach(a=>{t[a]=e[a]}),t}function h(e){if(typeof e!="string")throw new Error("@vercel/edge-config: Expected key to be a string")}function p(e){if(!Array.isArray(e)||e.some(r=>typeof r!="string"))throw new Error("@vercel/edge-config: Expected keys to be an array of string")}function u(e){return typeof structuredClone=="function"?structuredClone(e):e===void 0?e:JSON.parse(JSON.stringify(e))}function R(e){try{let r=new URL(e);if(r.host!=="edge-config.vercel.com"||r.protocol!=="https:"||!r.pathname.startsWith("/ecfg"))return null;let t=r.pathname.split("/")[1];if(!t)return null;let a=r.searchParams.get("token");return!a||a===""?null:{id:t,token:a}}catch{return null}}var E=new Map;async function l(e,r={}){let{headers:t=new Headers,...a}=r,c=t.get("Authorization"),n=`${e},${c||""}`,s=E.get(n);if(s){let{etag:D,response:C}=s,N=new Headers(t);N.set("If-None-Match",D);let f=await fetch(e,{...a,headers:N});if(f.status===304)return f.cachedResponseBody=JSON.parse(C),f;let v=f.headers.get("ETag");return f.ok&&v&&E.set(n,{etag:v,response:await f.clone().text()}),f}let o=await fetch(e,r),d=o.headers.get("ETag");return o.ok&&d&&E.set(n,{etag:d,response:await o.clone().text()}),o}var U=x(require("fs/promises"),1);async function w(e){if(!process.env.AWS_LAMBDA_FUNCTION_NAME)return null;try{let r=await U.default.readFile(`/opt/edge-config/${e.id}.json`,"utf-8");return JSON.parse(r)}catch{return null}}function G(e){if(!e)throw new Error("@vercel/edge-config: No connection string provided");let r=R(e);if(!r)throw new Error("@vercel/edge-config: Invalid connection string provided");let t=`https://edge-config.vercel.com/${r.id}`,a="1",c={Authorization:`Bearer ${r.token}`};return{async get(n){let s=await w(r);return s?(h(n),Promise.resolve(u(s.items[n]))):(h(n),l(`${t}/item/${n}?version=${a}`,{headers:new Headers(c),cache:"no-store"}).then(async o=>{if(o.ok)return o.json();if(await o.arrayBuffer(),o.status===401)throw new Error(i.UNAUTHORIZED);if(o.status===404){if(o.headers.has("x-edge-config-digest"))return;throw new Error(i.EDGE_CONFIG_NOT_FOUND)}if(o.cachedResponseBody!==void 0)return o.cachedResponseBody;throw new Error(i.UNEXPECTED)},()=>{throw new Error(i.NETWORK)}))},async has(n){let s=await w(r);return s?(h(n),Promise.resolve(O(s.items,n))):(h(n),fetch(`${t}/item/${n}?version=${a}`,{method:"HEAD",headers:new Headers(c),cache:"no-store"}).then(o=>{if(o.status===401)throw new Error(i.UNAUTHORIZED);if(o.status===404){if(o.headers.has("x-edge-config-digest"))return!1;throw new Error(i.EDGE_CONFIG_NOT_FOUND)}if(o.ok)return!0;throw new Error(i.UNEXPECTED)},()=>{throw new Error(i.NETWORK)}))},async getAll(n){let s=await w(r);if(s)return n===void 0?Promise.resolve(u(s.items)):(p(n),Promise.resolve(u(T(s.items,n))));Array.isArray(n)&&p(n);let o=Array.isArray(n)?new URLSearchParams(n.map(d=>["key",d])).toString():null;return o===""?Promise.resolve({}):l(`${t}/items?version=${a}${o===null?"":`&${o}`}`,{headers:new Headers(c),cache:"no-store"}).then(async d=>{if(d.ok)return d.json();if(await d.arrayBuffer(),d.status===401)throw new Error(i.UNAUTHORIZED);if(d.status===404)throw new Error(i.EDGE_CONFIG_NOT_FOUND);if(d.cachedResponseBody!==void 0)return d.cachedResponseBody;throw new Error(i.UNEXPECTED)},()=>{throw new Error(i.NETWORK)})},async digest(){let n=await w(r);return n?Promise.resolve(n.digest):l(`${t}/digest?version=1`,{headers:new Headers(c),cache:"no-store"}).then(async s=>{if(s.ok)return s.json();if(await s.arrayBuffer(),s.cachedResponseBody!==void 0)return s.cachedResponseBody;throw new Error(i.UNEXPECTED)},()=>{throw new Error(i.NETWORK)})}}}var y;function H(){y||(y=G(process.env.EDGE_CONFIG))}var A=(...e)=>(H(),y.get(...e));async function S(e,{params:r}){let t=await A("main");return new Response(t[r.target])}0&&(module.exports={GET});
